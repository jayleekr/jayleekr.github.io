---
title: "Modern C++ì˜ L-Value, R-Value & Move Semantics ì´í•´í•˜ê¸°"
author: "Jay Lee"
pubDate: "2021-04-06 00:00:00"
categories: ["TechSavvy", "C++"]
tags: ["TechSavvy", "ProgrammingLanguage", "C++", "l-value", "r-value", "move"]
---

## Modern C++ì˜ L-Value, R-Value & Move Semantics ì´í•´í•˜ê¸°

### 0. ì„œë¬¸

ë³¸ê²©ì ìœ¼ë¡œ ë“¤ì–´ê°€ê¸° ì „ì—, ì°¸ì¡°(&)ì™€ í¬ì¸í„°(*)ì— ëŒ€í•œ ì´í•´ë¥¼ ë¹ ë¥´ê²Œ ë˜ì§šì–´ë´…ì‹œë‹¤.

> ì°¸ì¡°(&)ëŠ” í¬ì¸í„°(*)ì²˜ëŸ¼ ë©”ëª¨ë¦¬ ì–´ë”˜ê°€ì— ìœ„ì¹˜í•œ ê°ì²´ì˜ ì£¼ì†Œë¥¼ ì €ì¥í•©ë‹ˆë‹¤.
> í•˜ì§€ë§Œ ì°¸ì¡°ëŠ” í•œ ë²ˆ ì´ˆê¸°í™”ë˜ë©´ ë‹¤ë¥¸ ê°ì²´ë¥¼ ì°¸ì¡°í•˜ë„ë¡ ë³€ê²½í•  ìˆ˜ ì—†ê³  nullë¡œ ì„¤ì •í•  ìˆ˜ë„ ì—†ìŠµë‹ˆë‹¤.

ê°’ì€ ë‘ ê°€ì§€ íƒ€ì…ìœ¼ë¡œ ë¶„ë¥˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: l-valueì™€ r-value.
l-valueì™€ r-value(ì¢Œì¸¡ê°’ê³¼ ìš°ì¸¡ê°’)ì˜ ì •ì˜ëŠ” C ì–¸ì–´ì—ì„œ ìœ ë˜í–ˆìŠµë‹ˆë‹¤.

> ì¢Œì¸¡ê°’ì€ í• ë‹¹ë¬¸ì˜ ì™¼ìª½ì´ë‚˜ ì˜¤ë¥¸ìª½ ì–‘ìª½ì— ë‚˜íƒ€ë‚  ìˆ˜ ìˆëŠ” í‘œí˜„ì‹ì´ê³ , ìš°ì¸¡ê°’ì€ í• ë‹¹ë¬¸ì˜ ì˜¤ë¥¸ìª½ì—ë§Œ ë‚˜íƒ€ë‚  ìˆ˜ ìˆëŠ” í‘œí˜„ì‹ì…ë‹ˆë‹¤.

```cpp
int a = 0;  
a; // l-value
0; // r-value
Player player;
player; // l-value
Player(); // r-value
```

ì´ ì •ì˜ëŠ” C++ì—ì„œ ë‹¤ì†Œ ë‹¤ë¥´ê²Œ ë°œì „í–ˆìŠµë‹ˆë‹¤.

> L-valueëŠ” ë©”ëª¨ë¦¬ ìœ„ì¹˜ë¥¼ ì°¸ì¡°í•˜ë©° & ì—°ì‚°ìë¡œ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. R-valueëŠ” l-valueê°€ ì•„ë‹Œ ëª¨ë“  ê²ƒì…ë‹ˆë‹¤.
> L-valueëŠ” ê·¸ë“¤ì´ ë‚˜íƒ€ë‚˜ëŠ” í‘œí˜„ì‹ì„ ë„˜ì–´ì„œ ì§€ì†ë©ë‹ˆë‹¤
> R-valueëŠ” ê·¸ë“¤ì´ ë‚˜íƒ€ë‚˜ëŠ” í‘œí˜„ì‹ì„ ë„˜ì–´ì„œ ì§€ì†ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤
> L-valueëŠ” ëª…ëª…ëœ ë³€ìˆ˜ë¥¼ ì°¸ì¡°í•©ë‹ˆë‹¤ (&)
> R-valueëŠ” ì„ì‹œ ê°ì²´ë¥¼ ì°¸ì¡°í•©ë‹ˆë‹¤ (&&)

ì†”ì§íˆ, ì´ ì •ì˜ì¡°ì°¨ë„ ê½¤ ëª¨í˜¸í•´ì„œ ë§ì€ ì‚¬ëŒë“¤ì„ í˜¼ë€ìŠ¤ëŸ½ê²Œ í•©ë‹ˆë‹¤.

l-valueì™€ r-valueë¥¼ ë‹¨ê³„ë³„ë¡œ ìì„¸íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤...

### 1. L-Values

L-valueëŠ” ìƒëŒ€ì ìœ¼ë¡œ ê°„ë‹¨í•©ë‹ˆë‹¤.

ë‹¤ìŒì€ l-valueë¡œ ë¶„ë¥˜ë˜ëŠ” ê²ƒë“¤ì…ë‹ˆë‹¤:
- **ë‹¨ì¼ í‘œí˜„ì‹ì„ ë„˜ì–´ì„œ ì§€ì†ë˜ëŠ” ê°ì²´ë“¤!**
  - ì£¼ì†Œë¥¼ ê°€ì§
  - ëª…ëª…ëœ ë³€ìˆ˜
  - const ë³€ìˆ˜
  - ë°°ì—´ ë³€ìˆ˜
  - ë¹„íŠ¸ í•„ë“œ
  - ê³µìš©ì²´
  - í´ë˜ìŠ¤ ë©¤ë²„
  - l-value ì°¸ì¡°(&)ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ í˜¸ì¶œ
  - ë¬¸ìì—´ ë¦¬í„°ëŸ´

ê·¸ë ‡ë‹¤ë©´ l-value í• ë‹¹ê³¼ ì°¸ì¡°ëŠ” ì–´ë–»ê²Œ ì‘ë™í• ê¹Œìš”?

ì•„ë˜ ì½”ë“œì™€ ì£¼ì„ì„ ì‚´í´ë´…ì‹œë‹¤.

```cpp
// ëª¨ë‘ l-valueì…ë‹ˆë‹¤
int a = 1;                    // ì „ì—­ ë³€ìˆ˜ a -> l-value
int& function(){              // l-value functionì€ ë°˜í™˜ëœ aì˜ ì£¼ì†Œë¡œ ì´ˆê¸°í™”ë¨
    a = 3;                    // a-> l-value, í• ë‹¹ ê°€ëŠ¥  
    return a;
}

int main()
{
    int i = 3;                // iëŠ” l-value
    i = 4;                    // iëŠ” l-value, í• ë‹¹ ê°€ëŠ¥
                              // i -> 4
    int *ptr = &i;            // iëŠ” l-value, & ì—°ì‚°ìë¡œ ì°¸ì¡° ê°€ëŠ¥, ptrì€ iì˜ ì£¼ì†Œë¥¼ ê°€ë¦¬í‚´
                              // *ptrì€ iì˜ ê°’ -> 4
    ptr = &a;                 // ptrì€ int * íƒ€ì… í¬ì¸í„°ì´ë¯€ë¡œ ì°¸ì¡°í•˜ëŠ” ê²ƒì„ ë³€ê²½ ê°€ëŠ¥
                              // *ptrì€ aì˜ ê°’ -> 1
    int & r = i;              // rì€ l-value iì˜ ì£¼ì†Œë¡œ ì´ˆê¸°í™”ë¨, ë”°ë¼ì„œ rì€ l-valueë¡œ í• ë‹¹ëœ l-value
    r = 5;                    // rì´ ê°€ë¦¬í‚¤ëŠ” ì£¼ì†Œì— ê°’ì„ ì”€, iì˜ ê°’ì„ ë³€ê²½ (rê³¼ i ë‘˜ ë‹¤ 5)
                              // rê³¼ i ë‘˜ ë‹¤ ê°™ì€ ì£¼ì†Œë¥¼ ê°€ë¦¬í‚´ -> 5
    int c = function();       // l-value ì°¸ì¡°ëŠ” ì´ˆê¸°í™” ì¤‘ì—ë§Œ ì£¼ì†Œë¥¼ ì €ì¥
                              // c -> ë‚´ë¶€ ìŠ¤íƒ ì—°ì‚° í›„ functionì˜ ë°˜í™˜ê°’, ë³€ê²½ëœ a ê°’ 3
    function() = 50;          // functionì€ l-value, r-value 50ì„ í• ë‹¹ ê°€ëŠ¥
                              // aì˜ ê°’ì´ 50ìœ¼ë¡œ ë³€ê²½ë¨. 
                              // ê·¸ë¦¬ê³  ptrì€ aì˜ ì£¼ì†Œë¥¼ ê°€ë¦¬í‚¤ë¯€ë¡œ *ptr -> 50ì´ í• ë‹¹ë¨.
    int d = a;                // l-value dì— aì˜ ê°’ 50ì´ í• ë‹¹ë¨
    int *ptr_2 = &function(); // int * íƒ€ì… ptr_2ëŠ” &function ì‚¬ìš© ê°€ëŠ¥ (functionì€ l-value)
                              // ë‚´ë¶€ ìŠ¤íƒ ì—°ì‚° í›„ functionì˜ ë°˜í™˜ê°’, ë³€ê²½ëœ a ê°’ 3
                              // * ptr_2 -> ë³€ê²½ëœ aì˜ ê°’ -> 3
                              // cì˜ ê°’ë„ ë³€ê²½ë¨ -> 3
                              // * ptrì˜ ê°’ë„ ë³€ê²½ë¨ -> 3
    return 0;
}
```

ìœ„ì—ì„œ ë³´ë“¯ì´ L-value í• ë‹¹ì€ ìƒëŒ€ì ìœ¼ë¡œ ëª…í™•í•˜ê³  ì´í•´í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.

### 2. R-Values

í•˜ì§€ë§Œ r-valueëŠ” ì •ì˜í•˜ê¸°ê°€ ë‹¤ì†Œ ì–´ë µìŠµë‹ˆë‹¤...

ë‹¤ìŒê³¼ ê°™ì´ ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- l-valueê°€ ì•„ë‹Œ ê°ì²´ë“¤... (ëŒ€ìš°ëª…ì œ ã…ã…..)
- **ì‚¬ìš©ë˜ëŠ” ë‹¨ì¼ í‘œí˜„ì‹ì„ ë„˜ì–´ì„œ ì§€ì†ë˜ì§€ ì•ŠëŠ” ì„ì‹œ ê°’ë“¤!**
  - ì£¼ì†Œê°€ ì—†ëŠ” ê°ì²´
  - ë¦¬í„°ëŸ´ (ë¬¸ìì—´ ë¦¬í„°ëŸ´ ì œì™¸)
  - ì°¸ì¡°ë¡œ ë°˜í™˜í•˜ì§€ ì•ŠëŠ” í•¨ìˆ˜ í˜¸ì¶œ (ì˜ˆ: int function())
  - i++ê³¼ i-- (í•˜ì§€ë§Œ ++iì™€ --i ì—°ì‚°ìëŠ” l-value)
  - ê¸°ë³¸ ì‚°ìˆ , ë…¼ë¦¬, ë¹„êµ í‘œí˜„ì‹ (+,-,*,=, &lt;,&gt; ë“±, ì—°ì‚°ì ì˜¤ë²„ë¡œë“œì— ë”°ë¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ)
  - ì—´ê±°í˜• (enum)
  - ëŒë‹¤ (ì»´íŒŒì¼ëŸ¬ëŠ” ëŒë‹¤/ìµëª… í•¨ìˆ˜ë¥¼ ì„ì‹œì ì¸ ê²ƒìœ¼ë¡œ ì²˜ë¦¬)

ëª‡ ê°€ì§€ ì˜ˆì œë¥¼ ì‚´í´ë´…ì‹œë‹¤.

R-value ì˜ˆì œ 1:

```cpp
int num1 = 10;
int num2 = 15;

if (num1 < num2) // (num1 < num2)ëŠ” r-value
{
    ...
}
```

R-value ì˜ˆì œ 2:

```cpp
int function();         // functionì€ í˜¸ì¶œ í›„ ì§€ì†ë˜ì§€ ì•ŠìŒ -> r-value 
function();             // r-value
int i = 0;
i = function();         // iëŠ” r-value functionì˜ ë°˜í™˜ê°’ìœ¼ë¡œ í• ë‹¹ëœ l-value
int *ptr = &function(); // ì—ëŸ¬!!! r-valueì˜ ì£¼ì†Œë¥¼ ì°¸ì¡°í•  ìˆ˜ ì—†ìŒ
```

ì›ë˜ C/C++ ì„¤ê³„ìë“¤ì€ r-valueë¥¼ ì„ì‹œ ê°ì²´ë¡œ ì •ì˜í–ˆìœ¼ë¯€ë¡œ, ê¸°ë³¸ì ìœ¼ë¡œ r-valueëŠ” í• ë‹¹ë  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ ì´ëŠ” Modern C++ (C++11)ì—ì„œ r-value "**move semantics**"ì˜ ë„ì…ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.

### 3. Move Semantics

ë‹¤ìŒ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê³ ë ¤í•´ë´…ì‹œë‹¤:

```cpp
//Math.cpp
std::vector<float> Math::ConvertToPercentage(const std::vector<float>& scores){
    std:vector<float> percentages;
    for (auto& score : scores){
        //...
    }
    return percentages;
}
// main.cpp
#include "Math.h"
int main(){
    std::vector<float> scores;
    //...
    scores = ConvertToPercentage(scores); 
    //...
}
```

mainì—ì„œ `ConvertToPercentage(scores)`ê°€ í˜¸ì¶œë  ë•Œ,
Math í´ë˜ìŠ¤ì˜ ì´ í•¨ìˆ˜ëŠ” percentagesë¼ëŠ” `std::vector<int>` íƒ€ì…ì˜ ì„ì‹œ ê°’ì¸ r-valueë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
ê·¸ëŸ° ë‹¤ìŒ í• ë‹¹ ì—°ì‚°ì "="ì— ì˜í•´ scoresì— í• ë‹¹ë©ë‹ˆë‹¤.

C++11 ì´ì „(Modern C++ ì´ì „)ì—ëŠ” ì–´ë–»ê²Œ ì‘ë™í–ˆì„ê¹Œìš”?

percentagesì˜ ì„ì‹œ ê°’ì´ scores ì´ˆê¸°í™” ì¤‘ì— ìƒì„±ëœ ë©”ëª¨ë¦¬ ì˜ì—­ì— **í• ë‹¹**ë  ë•Œ, **ë³µì‚¬**ë©ë‹ˆë‹¤.
ê·¸ëŸ° ë‹¤ìŒ Math::ConvertToPercentage í•¨ìˆ˜ ìŠ¤íƒì„ ë¹ ì ¸ë‚˜ê°€ë©´ì„œ ì„ì‹œ r-valueëŠ” ì‚¬ë¼ì§‘ë‹ˆë‹¤.

> ì—¬ê¸°ì— ê½¤ ë¶ˆí•„ìš”í•œ ê³¼ì •ì´ ìˆìŠµë‹ˆë‹¤ - percentages ì„ì‹œ ê°’ì´ **ë³µì‚¬**ë˜ëŠ” ìˆœê°„ì…ë‹ˆë‹¤.

ë…¼ë¦¬ì ìœ¼ë¡œ ìƒê°í•´ë´…ì‹œë‹¤.

ì„ì‹œ percentages ê²°ê³¼(r-value)ë¥¼ ì €ì¥í•˜ëŠ” ë©”ëª¨ë¦¬ ì˜ì—­ì„ scores ì´ˆê¸°í™” ì¤‘ì— ìƒì„±ëœ ë©”ëª¨ë¦¬ ì˜ì—­ê³¼ ë‹¨ìˆœíˆ **êµì²´**í•œë‹¤ë©´,
ìŠ¤íƒì„ ë¹ ì ¸ë‚˜ê°ˆ ë•Œ ì„ì‹œë¡œ ìƒì„±ëœ percentages ë©”ëª¨ë¦¬ ì˜ì—­ì€ ì–´ì°¨í”¼ ì‚¬ë¼ì§ˆ ê²ƒì´ë¯€ë¡œ, "**ë³µì‚¬**" ê³¼ì •ì´ ë¶ˆí•„ìš”í•´ì§‘ë‹ˆë‹¤.

ë¶ˆí•„ìš”í•œ **ë³µì‚¬**ë¥¼ ë°©ì§€í•˜ëŠ” ì´ ë°©ë²•ì´ Modern C++ì˜ r-value ì°¸ì¡°ì™€ Move Semanticsì˜ í•µì‹¬ì…ë‹ˆë‹¤.

> ì‚¬ì‹¤, ìš”ì¦˜ ìµœì‹  ì»´íŒŒì¼ëŸ¬ë“¤ì€ ì´ì— ëŒ€í•´ ê½¤ ë˜‘ë˜‘í•©ë‹ˆë‹¤... ë•Œë¡œëŠ” r-value ì°¸ì¡°ë¥¼ ê³¼ë„í•˜ê²Œ ì‚¬ìš©í•˜ë©´ ì‹¤ì œë¡œ ì‹œìŠ¤í…œì´ ëŠë ¤ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸ˜…

### 4. R-Value ì°¸ì¡° (&&)ì™€ std::move

R-value ì°¸ì¡°ëŠ” Modern C++ (C++11)ì—ì„œ ì²˜ìŒ ë„ì…ë˜ì—ˆìŠµë‹ˆë‹¤.
& ì—°ì‚°ìì™€ ìœ ì‚¬í•˜ê²Œ ì‘ë™í•©ë‹ˆë‹¤.

ì•„ë˜ ì˜ˆì œëŠ” move semanticsë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ë³¸ íƒ€ì…ì„ ì°¸ì¡°í•˜ëŠ” ê²ƒì„ ë³´ì—¬ì¤ë‹ˆë‹¤:

```cpp
#include <memory>
#include <utility>
float CalculateAverage(){
    float average=3;
    // ...
    return average;
}

int main(){
    int num = 10;                           // num -> l-value
    //int && rNum = num;                      // ì—ëŸ¬!!! numì€ l-value -> int & lnumì´ ê°€ëŠ¥
    int && rNum = std::move(num);           // moveëŠ” l-value numì„ ì°¸ì¡°í•  ìˆ˜ ìˆê²Œ í•¨
    num = 30;                               // numì„ ë³€ê²½í•˜ë©´ rNumë„ ë³€ê²½ë¨ (ì°¸ì¡°ê°’ì´ë¯€ë¡œ)
    
    int && rNum1 = 10;                       // OK, 10ì€ r-value
    
    float && rAverage = CalculateAverage();   // OK CalculateAverageëŠ” r-value
    float tmp_1 = std::move(rAverage);       // tmp_1ì€ l-valueì´ë¯€ë¡œ í• ë‹¹ë¨
    float tmp_2 = rAverage;                  // tmp_2ëŠ” l-valueì´ë¯€ë¡œ í• ë‹¹ë¨
    float && tmp_3 = std::move(rAverage);    // tmp_3ëŠ” l-valueì´ì§€ë§Œ r-value ì°¸ì¡°ê°’ì„
    rAverage = 1.0f;                         // rAverageë¥¼ ë³€ê²½í•˜ë©´ tmp_3ë§Œ ë³€ê²½ë¨, tmp_1ê³¼ tmp_2ëŠ” í• ë‹¹ëœ ê°’
}
```

## ë¶€ë¡.A ì°¸ê³ ìë£Œ

1. [https://m.blog.naver.com/yoochansong/222082508401](https://m.blog.naver.com/yoochansong/222082508401)
2. [https://docs.microsoft.com/ko-kr/cpp/cpp/references-cpp?view=msvc-160&viewFallbackFrom=vs-2019](https://docs.microsoft.com/ko-kr/cpp/cpp/references-cpp?view=msvc-160&viewFallbackFrom=vs-2019)
3. [https://skstormdummy.tistory.com/entry/%EC%9A%B0%EC%B8%A1-%EA%B0%92-%EC%B0%B8%EC%A1%B0-RValue-Reference](https://skstormdummy.tistory.com/entry/%EC%9A%B0%EC%B8%A1-%EA%B0%92-%EC%B0%B8%EC%A1%B0-RValue-Reference)
4. [https://modoocode.com/189](https://modoocode.com/189)